\documentclass[a4paper,12pt,oneside]{article}

% Imported packages
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{listings}
\usepackage{comment}
\usepackage{geometry}
\usepackage{wrapfig}
\usepackage{subfigure}

% Margin dimensions settings
\geometry{a4paper,top=2cm,bottom=2cm,left=2cm,right=2cm,%
heightrounded,bindingoffset=5mm}

% Enumeration settings
\renewcommand\thesubsection{\thesection.\alph{subsection}}

% Code visualization settings
\lstset{basicstyle=\small\ttfamily}

% Code design settings
\lstset{language=Matlab}

% Included images path
\graphicspath{{Images/}}

% Document information
\title{Fundamentals of Vibration Analysis and Vibroacoustics \\
Module 1 - Fundamentals of Vibration Analysis \\
Assignment 3 - Modal parameter identification}
\author{Bombaci Nicola 10677942 \\
Fantin Jacopo 10591775 \\
Intagliata Emanuele 10544878}
\date{May 2020}


\begin{document}

\maketitle

\vspace{100pt}

In this problem, we're given a small set of measurements we have to extract information from. The virtual experiment consists in a hammer hitting impulsively a structure in one point, and measuring the displacements in four different positions, one of which is where the force is applied (the first one). The initial data are wherefore the time axis $ t $ used to represent the sampled measurements and the force, the impulse-like input force $ F(t) $, and the four measurements:

\[
	t ~ \text{,} ~ F(t) ~ \text{,} ~ %
		x_1(t) ~ \text{,} ~ x_2(t) ~ \text{,} ~ x_3(t) ~ \text{,} ~ x_4(t)
\]

\section{Experimental FRFs}
\label{sec:experimental_frfs}

The Frequency Response Functions linking the displacement of the four points to the external force can be retrieved computing the ratio between the Discrete Fourier Transform (DFT) of the former and of the latter. We used the Matlab function \lstinline! fft() ! to find the DFT of the function input, here denoted with $ \mathcal{F[\cdot]} $, through an optimized Fast Fourier Transform algorithm.

%\begin{lstlisting}
%	H_exp = [fft(x1)./fft(F);
%		 fft(x2)./fft(F);
%		 fft(x3)./fft(F);
%		 fft(x4)./fft(F)];
%\end{lstlisting}

\[
	H^\textup{exp}_k(f) = \frac{\mathcal{F}[x_k(t)]}{\mathcal{F}[F(t)]} ~ \text{,} ~ %
		k = 1,2,3,4
\]

Note that the first element $ H^\textup{exp}_1(f) $ represents the co-located FRF. The corresponding plots are represented in magnitude and phase as follows:

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.4]{experimental_FRFs_modulus}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.4]{experimental_FRFs_phase}
\end{figure}


\section{Simplified methods for model identification}

To estimate the system parameters, we first reached for simplified methods. The assumption we are working under are, as usual, low damping (order of magnitude for $ \xi $: $ 10{-2} $), and well-distincted peaks in amplitude spectrum. As long as the damped natural frequencies are concerned, we found the relative maxima in each FRF setting one order of magnitude lower than the absolute maximum as threshold, and then found the frequencies corresponding to those values. The resulting matrix of damped natural frequencies is:

\[
	\mathbf{f_d} =	\begin{bmatrix}
										f_{\textup{d}_1}^{(1)}	& f_{\textup{d}_1}^{(2)} & %
											f_{\textup{d}_1}^{(3)}	& f_{\textup{d}_1}^{(4)} \\
										f_{\textup{d}_2}^{(1)}	& f_{\textup{d}_2}^{(2)} & %
											f_{\textup{d}_2}^{(3)}	& f_{\textup{d}_2}^{(4)} \\
										f_{\textup{d}_3}^{(1)}	& f_{\textup{d}_3}^{(2)} & %
											f_{\textup{d}_3}^{(3)}	& f_{\textup{d}_3}^{(4)} \\
										f_{\textup{d}_4}^{(1)}	& f_{\textup{d}_4}^{(2)} & %
											f_{\textup{d}_4}^{(3)}	& f_{\textup{d}_4}^{(4)} \\
									\end{bmatrix} = \begin{bmatrix}
																		1.0500	& 1.9667	& 2.6667	& 3.0833 \\
																		1.0500	& 1.9833	& 2.6667	& 3.0667 \\
																		1.0500	& 1.9833	& 2.6667	& 3.0667 \\
																		1.0500	& 1.9833	& 2.6667	& 3.0667
																	\end{bmatrix}
\]

where every row corresponds to one of the four different measurements, and each column to a vibration mode. The values are affected by small fluctuations as for the 2\textsuperscript{nd} and 4\textsuperscript{th} frequency, but only for the first measurement. We can therefore reckon this is just due to numerical errors.

As a second step, we searched for the adimensional damping ratios, applying the half-power bandwidth method. This exploits the relationship between the width of a resonating mode bell-like peak and the damping ratio, which are dirctly proportional. Each ratio for each measurement is computed thanks to the formula

\[
	\xi_i = \frac{(f^{(i)}_2)^2 - (f^{(i)}_1)^2}{4 \, (f^{(i)}_\textup{d})^2} %
		~ \text{,} ~ i = 1,2,3,4
\]

$ i $ being the mode number. The resulting matrix of damping ratios is:

\[
	\bm{\xi} =	\begin{bmatrix}
								\xi_1^{(1)}	& \xi_1^{(2)} & \xi_1^{(3)}	& \xi_1^{(4)} \\
								\xi_2^{(1)}	& \xi_2^{(2)} & \xi_2^{(3)}	& \xi_2^{(4)} \\
								\xi_3^{(1)}	& \xi_3^{(2)} & \xi_3^{(3)}	& \xi_3^{(4)} \\
								\xi_4^{(1)}	& \xi_4^{(2)} & \xi_4^{(3)}	& \xi_4^{(4)} \\
							\end{bmatrix} = \begin{bmatrix}
																0.0159	& 0.0128	& 0.0062	& 0.0081 \\
																0.0159	& 0.0084	& 0.0062	& 0.0054 \\
																0.0159	& 0.0128	& 0.0094	& 0.0054 \\
																0.0159	& 0.0126	& 0.0062	& 0.0081
															\end{bmatrix}
\]

organized like the damped natural frequency matrix. This time, the values vary a little more than before: this is due to non-negligible variations of the peaks width relative to the same resonance in distinct measurements, especially for mode 2 in measurement 2 and mode 3 in measurement 3. As for the 4\textsuperscript{th} mode, conformity between measurement 1 and 4 and between measurement 2 and 3 may be observed. Values for the 1\textsuperscript{st} mode are the most accurate both for the frequency value and for the damping ratio, in accordance to the fact the more the resonances are %low in frequency, the less they "pack up", the easier it is to make an estimation. In other words, they correspond to clearer and higher peaks.
clear and their peaks are sharp for each measurement, the easier it is to make an estimation, because values will tend to be the same for all of the measurements. In fact, the first mode corresponds to a very clear peak for each of them.

Finally, the mode shape of i-th mode is estimated equalling the experimental FRF for measurement $ k = 1,2,3,4 $, computed in the previous section and evaluated at the i-th resonance frequency, $ i = 1,2,3,4 $, to the approximated FRF $ H^{\textup{approx}^{(i)}}_k $ connecting displacement of point $ k $ and the force, evaluated at the resonant frequencies. The mode shape element relative to the force application position has been neglected, being it 

\[ \begin{split}
	& H^{\textup{exp}}_k(\omega_{\textup{d}_k}^{(i)}) \approx %
		H^{\textup{approx}^{(i)}}_k(\omega_{\textup{d}_k}^{(i)}) = %
		\frac{\phi^{(i)}_k} %
		{-m^{(i)}_k \, \omega^2 + j \, \omega \, c^{(i)}_k + k^{(i)}_k} %
		\Big|_{\omega = \omega_{\textup{d}_k}^{(i)}} = %
		\frac{\phi^{(i)}_k}{j \, \omega_{\textup{d}_k}^{(i)} \, c^{(i)}_k} = %
		-j \, \frac{\phi^{(i)}_k}{\omega_{\textup{d}_k}^{(i)} \, c^{(i)}_k} \\
	& \Rightarrow ~ %
		j \, \frac{\phi^{(i)}_k}{\omega_{\textup{d}_k}^{(i)} \, c^{(i)}_k} = %
		- H^{\textup{exp}}_k(\omega_{\textup{d}_k}^{(i)}) %
		~ \Rightarrow ~ \frac{\phi^{(i)}_k}{\omega_{\textup{d}_k}^{(i)} \, c^{(i)}_k} = %
		\Im\{- H^{\textup{exp}}_k(\omega_{\textup{d}_k}^{(i)})\} = %
		- \Im\{H^{\textup{exp}}_k(\omega_{\textup{d}_k}^{(i)})\} \\
	& \Rightarrow ~ \phi^{(i)}_k = %
		- \Im\{H^{\textup{exp}}_k(\omega_{\textup{d}_k}^{(i)})\} %
		\, \omega_{\textup{d}_k}^{(i)} \, c^{(i)}_k ~ \text{,} ~ i,k = 1,2,3,4
\end{split} \]

where the contributions of other modes other than the i-th mode has been neglected in the computation of the i-th mode shape. The damping coefficients $ c^{(i)}_k $ have been derived from the damping ratios following the definition of damping ratio:

\[ \begin{split}
	\xi^{(i)}_k = \frac{c^{(i)}_k}{2 \, m^{(i)}_k \, \omega_{\textup{d}_k}^{(i)}} %
		~ \Rightarrow ~ c^{(i)}_k = 2 \, \xi^{(i)}_k \, m^{(i)}_k \, %
		\omega_{\textup{d}_k}^{(i)}
\end{split} \]

and setting the elements of the modal mass matrix $ m^{(i)}_k $ to 1.
The modal matrix of all the elements $ \phi^{(i)}_k $ is reported here:

\[
	\bm{\phi} =	\begin{bmatrix}
								\phi_1^{(1)}	& \phi_1^{(2)} & \phi_1^{(3)}	& \phi_1^{(4)} \\
								\phi_2^{(1)}	& \phi_2^{(2)} & \phi_2^{(3)}	& \phi_2^{(4)} \\
								\phi_3^{(1)}	& \phi_3^{(2)} & \phi_3^{(3)}	& \phi_3^{(4)} \\
								\phi_4^{(1)}	& \phi_4^{(2)} & \phi_4^{(3)}	& \phi_4^{(4)} \\
							\end{bmatrix} = \begin{bmatrix}
																0.1050	& 0.3438	& 0.2130	& 0.0683 \\
																0.1642	& 0.1065	& -0.1725	& -0.1071 \\
																0.1519	& -0.2704	& -0.1083	& 0.1195 \\
																0.0735	& -0.2841	& 0.2303	& -0.1465
															\end{bmatrix}
\]

Normalizing the elements of each measure taking the first one as reference the result is

\[
	\bm{\phi} =	\begin{bmatrix}
								1				& 1				& 1				& 1 \\
								1.5632	& 0.3098	& -0.8098	& -1.5669 \\
								1.4459	& -0.7867 & -0.5087	& 1.7482 \\
								0.7000	& -0.8264 & 1.0811	& -2.1442 \\
							\end{bmatrix}
\]

\vspace{10pt}

These values are in agreement with the magnitude and phase plots of \ref{sec:experimental_frfs}: the modulus of $ \phi^{(i)}_k $ is approximatedly the relative value in the amplitude plots, while its sign follows the sign of the phase in the phase plots. The biggest divergence between the absolute value of the elements in the modal matrix and the plotted values is about measurement 3, 3\textsuperscript{rd} mode, which should have a relative magnitude of $ \frac{1}{3} $ with respect to the 1\textsuperscript{st} measurement, but the corresponding element in $ \bm{\phi} $ indicates $ \frac{1}{2} $. This is certainly due to the approximated values of the modal matrix, obtained by means of a simplified method. In the next section, we go on with the analysis using a more accurate procedure, which is a modal parameter identification model.


\end{document}
